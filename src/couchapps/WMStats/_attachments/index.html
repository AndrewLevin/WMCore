<html>
  <head>
    <title>WMStats</title>
    <style type="text/css" title="currentStyle">
        @import "css/basic_table.css";
        @import "css/basic_div.css";
        @import "css/ColVis.css";
        @import "css/layout-default-latest.css";
        @import "css/jquery-ui-1.8.18.custom.css";
    </style>
    </style>
    <!-- Brings in all the dependencies needed for this couchapp -->
    <script src="js/loader.js" type='text/javascript'> </script>

    <!-- Globals is needed to be loaded before other library -->
    <script src="js/WMStats.Globals.js" type='text/javascript'> </script>
    <script src="js/WMStats.Table.js" type='text/javascript'> </script>
    <script src="js/WMStats.Couch.js" type='text/javascript'> </script>
    
    <!-- Overview.js will load javascripts corresponding to variant dynamically  -->
    <script src="js/WMStats.Overview.js" type='text/javascript'> </script>

    <script src="js/WMStats.Requests.js" type='text/javascript'> </script>
    <script src="js/WMStats.RequestTable.js" type='text/javascript'> </script>
    <!-- RequestView.js will load javascripts corresponding to variant dynamically  -->
    <script src="js/WMStats.RequestView.js" type='text/javascript'> </script>

    <script src="js/WMStats.SiteView.js" type='text/javascript'> </script>
    <script src="js/WMStats.JobSummaryView.js" type='text/javascript'> </script>
    <script src="js/WMStats.JobDetailView.js" type='text/javascript'> </script>
    <script src="js/WMStats.AgentView.js" type='text/javascript'> </script>
    <script src="js/WMStats.AlertView.js" type='text/javascript'> </script>
    <script src="js/WMStats.EventHandler.js" type='text/javascript'> </script>
    <script>
    
    function applyTemplate(){
        var tablePane = $('div.tablePane');
        $('div.template.captionTable').children().clone().appendTo(tablePane);
    }
    
    function drawMonitor() {
        // select initial summary view by global value (tier0, tier1, analysis)
        WMStats.Overview.createTable("#tab-overview > div[name='overview'] > div.body");
        WMStats.SiteView.createTable("#tab-site > div[name='overview'] > div.body");
        WMStats.AlertView.createTable("#tab-alert > div[name='requestSummary'] > div.body");
        WMStats.AgentView.createTable("#agentDiv");
    }
    $(document).ready(function() {
        //myLayout = $('body').layout();
        $("#tabs").tabs();
        applyTemplate();
        drawMonitor();
        //position the job block against request block
        //$("div[name='requestSummary']").position({my:'left top', at:'left bottom', 
        //                          of:"div[name='overview']", offset:'0 20'})
        //$("div[name='jobSummary']").position({my:'left top', at:'left bottom', 
        //                          of:"div[name='requestSummary']", offset:'0 20'})
        // refresh table every 10 min                          
        setInterval(drawMonitor, 600000)
     } );
    </script>
  </head>
<body>
    <div class="middle">
        <div id="tabs">
            <ul>
                <li><a href="#tab-overview">Campaign view</a></li>
                <li><a href="#tab-site">Site view</a></li>
                <li><a href="#tab-alert">Alert view</a></li>
                <li><a href="#tab-agent">Agent view</a></li>
            </ul>
            <div class="module" id="tab-overview">
                <div class="tablePane" name="overview"></div>
                <div class="tablePane" name="requestSummary"></div>
                <div class="tablePane" name="jobSummary"></div>
                <div class="tablePane" name="jobDetail"></div>
            </div>
            <div class="module" id="tab-site">
                <div class="tablePane" name="overview"></div>
                <div class="tablePane" name="requestSummary"></div>
                <div class="tablePane" name="jobSummary"></div>
                <div class="tablePane" name="jobDetail"></div>
            </div>
            <div class="module" id="tab-alert">
                <div class="tablePane" name="requestSummary"></div>
                <div class="tablePane" name="jobSummary"></div>
                <div class="tablePane" name="jobDetail"></div>
            </div>
            <div id="tab-agent">
                <div id="agentDiv"></div>
            </div>
        </div>
    </div>
    <div id="loading_page">
        Loading ...
    </div>
    <div id="templates">
        <div class="template captionTable">
            <div class="caption">
                <span></span>
                <img src="images/rollup.gif" alt="rollup" title="rolls up this module"/>
            </div>
            <div class="body">
               <table cellpadding="0" cellspacing="0" border="0" class="display"></table>
            </div>
        </div>
    </div>
</body>
</html>
