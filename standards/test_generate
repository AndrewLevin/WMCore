#!/usr/bin/env python

import os
import sys

from WMQuality.Code import Code
from WMQuality.Test import Test

userIn = raw_input('This assumes you generated a cvs log in the file "cvsLog.txt. Have you? Y/n')
if userIn != 'Y':
    sys.exit(0)

qualityScript = os.path.join(os.getenv('WMCOREBASE'), 'standards/test_style.sh')
# output file:
qualityReport = os.path.join(os.getenv('WMCOREBASE'), 'standards/codeQuality.txt')
# rating threshold (min: 0, max 10)
threshold = 8

#code = Code(qualityScript, qualityReport, os.getenv('WMCOREBASE'), threshold)
#code.parseCVS('cvsLog.txt', pathCut = 5, moduleCut = 1, maxVotes = 3)
#code.generate('test_style')

test = Test()
test.parseCVS('cvsLog.txt', pathCut = 5, moduleCut = 1, maxVotes = 3)
test.generate('conf_test_mysql.py')
test.generate('conf_test_oracle.py')
test.missingTests('missingTests.txt')

print("Generated: test_style, conf_test_mysql.py, conf_test_orale.py, missingTests.txt")
print("Edit generated files as necessary. E.g. some tests do only run on 1 backend (oracle/mysql)")



